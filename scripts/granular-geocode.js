const fs = require('fs');
const path = require('path');

const DATA_FILE = path.join(__dirname, '../data/facilities.json');

// ëŒ€í•œë¯¼êµ­ ì‹œ/êµ°/êµ¬ ë‹¨ìœ„ ì¢Œí‘œ ë°ì´í„° (ì•½ 200+ê°œ)
const DISTRICT_COORDS = {
    // ì„œìš¸íŠ¹ë³„ì‹œ
    'ì¢…ë¡œêµ¬': { lat: 37.5730, lng: 126.9794 },
    'ì¤‘êµ¬': { lat: 37.5641, lng: 126.9979 },
    'ìš©ì‚°êµ¬': { lat: 37.5323, lng: 126.9907 },
    'ì„±ë™êµ¬': { lat: 37.5635, lng: 127.0368 },
    'ê´‘ì§„êµ¬': { lat: 37.5385, lng: 127.0823 },
    'ë™ëŒ€ë¬¸êµ¬': { lat: 37.5744, lng: 127.0400 },
    'ì¤‘ë‘êµ¬': { lat: 37.6063, lng: 127.0932 },
    'ì„±ë¶êµ¬': { lat: 37.5891, lng: 127.0182 },
    'ê°•ë¶êµ¬': { lat: 37.6396, lng: 127.0255 },
    'ë„ë´‰êµ¬': { lat: 37.6688, lng: 127.0471 },
    'ë…¸ì›êµ¬': { lat: 37.6542, lng: 127.0568 },
    'ì€í‰êµ¬': { lat: 37.6027, lng: 126.9291 },
    'ì„œëŒ€ë¬¸êµ¬': { lat: 37.5791, lng: 126.9368 },
    'ë§ˆí¬êµ¬': { lat: 37.5665, lng: 126.9016 },
    'ì–‘ì²œêµ¬': { lat: 37.5169, lng: 126.8660 },
    'ê°•ì„œêµ¬': { lat: 37.5509, lng: 126.8497 },
    'êµ¬ë¡œêµ¬': { lat: 37.4954, lng: 126.8874 },
    'ê¸ˆì²œêµ¬': { lat: 37.4565, lng: 126.8954 },
    'ì˜ë“±í¬êµ¬': { lat: 37.5264, lng: 126.8960 },
    'ë™ì‘êµ¬': { lat: 37.5124, lng: 126.9393 },
    'ê´€ì•…êµ¬': { lat: 37.4784, lng: 126.9517 },
    'ì„œì´ˆêµ¬': { lat: 37.4837, lng: 127.0324 },
    'ê°•ë‚¨êµ¬': { lat: 37.5172, lng: 127.0473 },
    'ì†¡íŒŒêµ¬': { lat: 37.5145, lng: 127.1066 },
    'ê°•ë™êµ¬': { lat: 37.5301, lng: 127.1238 },

    // ê²½ê¸°ë„
    'ìˆ˜ì›ì‹œ': { lat: 37.2636, lng: 127.0286 },
    'ì¥ì•ˆêµ¬': { lat: 37.3038, lng: 127.0076 }, // ìˆ˜ì› ê¶Œì„  ë“± ìƒì„¸
    'ê¶Œì„ êµ¬': { lat: 37.2575, lng: 126.9715 },
    'íŒ”ë‹¬êµ¬': { lat: 37.2820, lng: 127.0197 },
    'ì˜í†µêµ¬': { lat: 37.2596, lng: 127.0515 },
    'ì„±ë‚¨ì‹œ': { lat: 37.4200, lng: 127.1265 },
    'ìˆ˜ì •êµ¬': { lat: 37.4504, lng: 127.1425 },
    'ì¤‘ì›êµ¬': { lat: 37.4363, lng: 127.1704 },
    'ë¶„ë‹¹êµ¬': { lat: 37.3827, lng: 127.1189 },
    'ì˜ì •ë¶€ì‹œ': { lat: 37.7381, lng: 127.0337 },
    'ì•ˆì–‘ì‹œ': { lat: 37.3943, lng: 126.9568 },
    'ë§Œì•ˆêµ¬': { lat: 37.4082, lng: 126.9099 },
    'ë™ì•ˆêµ¬': { lat: 37.3908, lng: 126.9547 },
    'ë¶€ì²œì‹œ': { lat: 37.5034, lng: 126.7660 },
    'ê´‘ëª…ì‹œ': { lat: 37.4784, lng: 126.8647 },
    'í‰íƒì‹œ': { lat: 36.9925, lng: 127.1127 },
    'ë™ë‘ì²œì‹œ': { lat: 37.9036, lng: 127.0604 },
    'ì•ˆì‚°ì‹œ': { lat: 37.3217, lng: 126.8309 },
    'ìƒë¡êµ¬': { lat: 37.3060, lng: 126.8517 },
    'ë‹¨ì›êµ¬': { lat: 37.3204, lng: 126.8123 },
    'ê³ ì–‘ì‹œ': { lat: 37.6584, lng: 126.8320 },
    'ë•ì–‘êµ¬': { lat: 37.6372, lng: 126.8354 },
    'ì¼ì‚°': { lat: 37.6584, lng: 126.7725 }, // ì¼ì‚°ë™êµ¬/ì„œêµ¬
    'ê³¼ì²œì‹œ': { lat: 37.4292, lng: 126.9877 },
    'êµ¬ë¦¬ì‹œ': { lat: 37.5943, lng: 127.1296 },
    'ë‚¨ì–‘ì£¼ì‹œ': { lat: 37.6360, lng: 127.2165 },
    'ì˜¤ì‚°ì‹œ': { lat: 37.1500, lng: 127.0776 },
    'ì‹œí¥ì‹œ': { lat: 37.3801, lng: 126.8031 },
    'êµ°í¬ì‹œ': { lat: 37.3611, lng: 126.9352 },
    'ì˜ì™•ì‹œ': { lat: 37.3446, lng: 126.9682 },
    'í•˜ë‚¨ì‹œ': { lat: 37.5393, lng: 127.2148 },
    'ìš©ì¸ì‹œ': { lat: 37.2410, lng: 127.1775 },
    'ì²˜ì¸êµ¬': { lat: 37.2343, lng: 127.2013 },
    'ê¸°í¥êµ¬': { lat: 37.2797, lng: 127.1147 },
    'ìˆ˜ì§€êµ¬': { lat: 37.3294, lng: 127.0980 },
    'íŒŒì£¼ì‹œ': { lat: 37.7601, lng: 126.7801 },
    'ì´ì²œì‹œ': { lat: 37.2721, lng: 127.4348 },
    'ì•ˆì„±ì‹œ': { lat: 37.0080, lng: 127.2801 },
    'ê¹€í¬ì‹œ': { lat: 37.6152, lng: 126.7157 },
    'í™”ì„±ì‹œ': { lat: 37.1995, lng: 126.8315 },
    'ê´‘ì£¼ì‹œ': { lat: 37.4292, lng: 127.2548 }, // ê²½ê¸° ê´‘ì£¼
    'ì–‘ì£¼ì‹œ': { lat: 37.7853, lng: 127.0457 },
    'í¬ì²œì‹œ': { lat: 37.8949, lng: 127.2003 },
    'ì—¬ì£¼ì‹œ': { lat: 37.2985, lng: 127.6373 },
    'ì—°ì²œêµ°': { lat: 38.0964, lng: 127.0749 },
    'ê°€í‰êµ°': { lat: 37.8315, lng: 127.5097 },
    'ì–‘í‰êµ°': { lat: 37.4912, lng: 127.4878 },

    // ê°•ì›ë„
    'ì¶˜ì²œì‹œ': { lat: 37.8812, lng: 127.7300 },
    'ì›ì£¼ì‹œ': { lat: 37.3421, lng: 127.9197 },
    'ê°•ë¦‰ì‹œ': { lat: 37.7518, lng: 128.8760 },
    'ë™í•´ì‹œ': { lat: 37.5247, lng: 129.1143 },
    'íƒœë°±ì‹œ': { lat: 37.1641, lng: 128.9856 },
    'ì†ì´ˆì‹œ': { lat: 38.2070, lng: 128.5919 },
    'ì‚¼ì²™ì‹œ': { lat: 37.4497, lng: 129.1652 },
    'í™ì²œêµ°': { lat: 37.6972, lng: 127.8887 },
    'íš¡ì„±êµ°': { lat: 37.4883, lng: 127.9849 },
    'ì˜ì›”êµ°': { lat: 37.1836, lng: 128.4619 },
    'í‰ì°½êµ°': { lat: 37.3705, lng: 128.3902 },
    'ì •ì„ êµ°': { lat: 37.3807, lng: 128.6608 },
    'ì² ì›êµ°': { lat: 38.1466, lng: 127.3134 },
    'í™”ì²œêµ°': { lat: 38.1062, lng: 127.7082 },
    'ì–‘êµ¬êµ°': { lat: 38.1096, lng: 127.9902 },
    'ì¸ì œêµ°': { lat: 38.0694, lng: 128.1706 },
    'ê³ ì„±êµ°': { lat: 38.3804, lng: 128.4682 }, // ê°•ì›

    // ì¶©ì²­ë¶ë„
    'ì²­ì£¼ì‹œ': { lat: 36.6424, lng: 127.4890 },
    'ì²­ì£¼': { lat: 36.6424, lng: 127.4890 },
    'ìƒë‹¹êµ¬': { lat: 36.6117, lng: 127.5256 },
    'ì¶©ì£¼ì‹œ': { lat: 36.9912, lng: 127.9259 },
    'ì œì²œì‹œ': { lat: 37.1325, lng: 128.1906 },
    'ë³´ì€êµ°': { lat: 36.4894, lng: 127.7297 },
    'ì˜¥ì²œêµ°': { lat: 36.3065, lng: 127.5714 },
    'ì˜ë™êµ°': { lat: 36.1751, lng: 127.7770 },
    'ì¦í‰êµ°': { lat: 36.7854, lng: 127.5815 },
    'ì§„ì²œêµ°': { lat: 36.8553, lng: 127.4357 },
    'ê´´ì‚°êµ°': { lat: 36.8152, lng: 127.7865 },
    'ìŒì„±êµ°': { lat: 36.9402, lng: 127.6905 },
    'ë‹¨ì–‘êµ°': { lat: 36.9847, lng: 128.3653 },

    // ì¶©ì²­ë‚¨ë„
    'ì²œì•ˆì‹œ': { lat: 36.8151, lng: 127.1139 },
    'ê³µì£¼ì‹œ': { lat: 36.4526, lng: 127.1217 },
    'ë³´ë ¹ì‹œ': { lat: 36.3330, lng: 126.6129 },
    'ì•„ì‚°ì‹œ': { lat: 36.7898, lng: 127.0019 },
    'ì„œì‚°ì‹œ': { lat: 36.7845, lng: 126.4503 },
    'ë…¼ì‚°ì‹œ': { lat: 36.1872, lng: 127.0988 },
    'ê³„ë£¡ì‹œ': { lat: 36.2743, lng: 127.2486 },
    'ë‹¹ì§„ì‹œ': { lat: 36.8906, lng: 126.6290 },
    'ê¸ˆì‚°êµ°': { lat: 36.1086, lng: 127.4883 },
    'ë¶€ì—¬êµ°': { lat: 36.2753, lng: 126.9098 },
    'ì„œì²œêµ°': { lat: 36.0805, lng: 126.6914 },
    'ì²­ì–‘êµ°': { lat: 36.4589, lng: 126.8030 },
    'í™ì„±êµ°': { lat: 36.6012, lng: 126.6608 },
    'ì˜ˆì‚°êµ°': { lat: 36.6811, lng: 126.8453 },
    'íƒœì•ˆêµ°': { lat: 36.7547, lng: 126.2979 },

    // ì „ë¼ë¶ë„
    'ì „ì£¼ì‹œ': { lat: 35.8242, lng: 127.1480 },
    'êµ°ì‚°ì‹œ': { lat: 35.9675, lng: 126.7369 },
    'ìµì‚°ì‹œ': { lat: 35.9483, lng: 126.9577 },
    'ì •ìì‹œ': { lat: 35.5699, lng: 126.8577 },
    'ë‚¨ì›ì‹œ': { lat: 35.4163, lng: 127.3904 },
    'ê¹€ì œì‹œ': { lat: 35.8035, lng: 126.8809 },
    'ì™„ì£¼êµ°': { lat: 35.9048, lng: 127.1620 },
    'ì§„ì•ˆêµ°': { lat: 35.7915, lng: 127.4249 },
    'ë¬´ì£¼êµ°': { lat: 36.0069, lng: 127.6601 },
    'ì¥ìˆ˜êµ°': { lat: 35.6476, lng: 127.5218 },
    'ì„ì‹¤êµ°': { lat: 35.6177, lng: 127.2889 },
    'ìˆœì°½êµ°': { lat: 35.3745, lng: 127.1374 },
    'ê³ ì°½êµ°': { lat: 35.4358, lng: 126.7020 },
    'ë¶€ì•ˆêµ°': { lat: 35.7317, lng: 126.7335 },

    // ì „ë¼ë‚¨ë„
    'ëª©í¬ì‹œ': { lat: 34.8118, lng: 126.3922 },
    'ì—¬ìˆ˜ì‹œ': { lat: 34.7603, lng: 127.6622 },
    'ìˆœì²œì‹œ': { lat: 34.9507, lng: 127.4870 },
    'ë‚˜ì£¼ì‹œ': { lat: 35.0160, lng: 126.7110 },
    'ê´‘ì–‘ì‹œ': { lat: 34.9407, lng: 127.6958 },
    'ë‹´ì–‘êµ°': { lat: 35.3211, lng: 126.9880 },
    'ê³¡ì„±êµ°': { lat: 35.2819, lng: 127.2917 },
    'ê³¡ì„±': { lat: 35.2819, lng: 127.2917 },
    'êµ¬ë¡€êµ°': { lat: 35.2023, lng: 127.4630 },
    'ê³ í¥êµ°': { lat: 34.6111, lng: 127.2858 },
    'ë³´ì„±êµ°': { lat: 34.7715, lng: 127.0797 },
    'í™”ìˆœêµ°': { lat: 35.0641, lng: 126.9868 },
    'ì¥í¥êµ°': { lat: 34.6816, lng: 126.9073 },
    'ê°•ì§„êµ°': { lat: 34.6421, lng: 126.7672 },
    'í•´ë‚¨êµ°': { lat: 34.5739, lng: 126.5991 },
    'ì˜ì•”êµ°': { lat: 34.8001, lng: 126.6968 },
    'ë¬´ì•ˆêµ°': { lat: 34.9904, lng: 126.4817 },
    'í•¨í‰êµ°': { lat: 35.0657, lng: 126.5167 },
    'ì˜ê´‘êµ°': { lat: 35.2773, lng: 126.5120 },
    'ì¥ì„±êµ°': { lat: 35.3018, lng: 126.7849 },
    'ì™„ë„êµ°': { lat: 34.3106, lng: 126.7550 },
    'ì§„ë„êµ°': { lat: 34.4868, lng: 126.2635 },
    'ì‹ ì•ˆêµ°': { lat: 34.8336, lng: 126.1086 },

    // ê²½ìƒë¶ë„
    'í¬í•­ì‹œ': { lat: 36.0190, lng: 129.3435 },
    'ê²½ì£¼ì‹œ': { lat: 35.8562, lng: 129.2247 },
    'ê¹€ì²œì‹œ': { lat: 36.1398, lng: 128.1136 },
    'ì•ˆë™ì‹œ': { lat: 36.5684, lng: 128.7294 },
    'êµ¬ë¯¸ì‹œ': { lat: 36.1195, lng: 128.3446 },
    'ì˜ì£¼ì‹œ': { lat: 36.8055, lng: 128.6241 },
    'ì˜ì²œì‹œ': { lat: 35.9733, lng: 128.9385 },
    'ìƒì£¼ì‹œ': { lat: 36.4109, lng: 128.1591 },
    'ë¬¸ê²½ì‹œ': { lat: 36.5865, lng: 128.1867 },
    'ê²½ì‚°ì‹œ': { lat: 35.8251, lng: 128.7414 },
    'êµ°ìœ„êµ°': { lat: 36.2427, lng: 128.5727 }, // ëŒ€êµ¬ í¸ì… ê³ ë ¤
    'ì˜ì„±êµ°': { lat: 36.3524, lng: 128.6971 },
    'ì²­ì†¡êµ°': { lat: 36.4363, lng: 129.0573 },
    'ì˜ì–‘êµ°': { lat: 36.6669, lng: 129.1124 },
    'ì˜ë•êµ°': { lat: 36.4150, lng: 129.3654 },
    'ì²­ë„êµ°': { lat: 35.6473, lng: 128.7340 },
    'ê³ ë ¹êµ°': { lat: 35.7259, lng: 128.2625 },
    'ì„±ì£¼êµ°': { lat: 35.9192, lng: 128.2831 },
    'ì¹ ê³¡êµ°': { lat: 35.9959, lng: 128.4016 },
    'ì˜ˆì²œêµ°': { lat: 36.6548, lng: 128.4526 },
    'ë´‰í™”êµ°': { lat: 36.8931, lng: 128.7325 },
    'ìš¸ì§„êµ°': { lat: 36.9934, lng: 129.4005 },
    'ìš¸ë¦‰êµ°': { lat: 37.4844, lng: 130.9056 },

    // ê²½ìƒë‚¨ë„
    'ì°½ì›ì‹œ': { lat: 35.2281, lng: 128.6811 },
    'ì˜ì°½êµ¬': { lat: 35.2530, lng: 128.6397 },
    'ì„±ì‚°êµ¬': { lat: 35.2158, lng: 128.6841 },
    'ë§ˆì‚°í•©í¬êµ¬': { lat: 35.1663, lng: 128.5649 },
    'ë§ˆì‚°íšŒì›êµ¬': { lat: 35.2343, lng: 128.5833 },
    'ì§„í•´êµ¬': { lat: 35.1394, lng: 128.7082 },
    'ì§„ì£¼ì‹œ': { lat: 35.1798, lng: 128.1077 },
    'í†µì˜ì‹œ': { lat: 34.8544, lng: 128.4332 },
    'ì‚¬ì²œì‹œ': { lat: 34.9542, lng: 128.0645 },
    'ê¹€í•´ì‹œ': { lat: 35.2285, lng: 128.8893 },
    'ë°€ì–‘ì‹œ': { lat: 35.5034, lng: 128.7466 },
    'ê±°ì œì‹œ': { lat: 34.8806, lng: 128.6211 },
    'ì–‘ì‚°ì‹œ': { lat: 35.3350, lng: 129.0373 },
    'ì˜ë ¹êµ°': { lat: 35.3223, lng: 128.2616 },
    'ì˜ë ¹': { lat: 35.3223, lng: 128.2616 },
    'í•¨ì•ˆêµ°': { lat: 35.2725, lng: 128.4065 },
    'ì°½ë…•êµ°': { lat: 35.5446, lng: 128.4922 },
    'ê³ ì„±êµ°(ê²½ë‚¨)': { lat: 34.9757, lng: 128.3235 }, // ê°•ì› ê³ ì„±ê³¼ êµ¬ë¶„
    'ë‚¨í•´êµ°': { lat: 34.8377, lng: 127.8924 },
    'í•˜ë™êµ°': { lat: 35.0672, lng: 127.7516 },
    'ì‚°ì²­êµ°': { lat: 35.4155, lng: 127.8732 },
    'í•¨ì–‘êµ°': { lat: 35.5205, lng: 127.7252 },
    'ê±°ì°½êµ°': { lat: 35.6865, lng: 127.9100 },
    'í•©ì²œêµ°': { lat: 35.5666, lng: 128.1658 },

    // ë¶€ì‚°ê´‘ì—­ì‹œ
    'ë¶€ì‚°': { lat: 35.1796, lng: 129.0756 },
    'ë¶€ì‚°ì§„êµ¬': { lat: 35.1631, lng: 129.0529 },
    'ë™ë˜êµ¬': { lat: 35.2049, lng: 129.0836 },
    'ë‚¨êµ¬': { lat: 35.1365, lng: 129.0842 },
    'ë¶êµ¬': { lat: 35.1970, lng: 128.9897 }, // ë¶€ì‚°
    'í•´ìš´ëŒ€êµ¬': { lat: 35.1631, lng: 129.1636 },
    'ì‚¬í•˜êµ¬': { lat: 35.1041, lng: 128.9751 },
    'ê¸ˆì •êµ¬': { lat: 35.2429, lng: 129.0924 },
    'ê°•ì„œêµ¬(ë¶€ì‚°)': { lat: 35.2122, lng: 128.9806 },
    'ê¸°ì¥êµ°': { lat: 35.2445, lng: 129.2223 },
    'ê¸°ì¥': { lat: 35.2445, lng: 129.2223 },

    // ëŒ€êµ¬ê´‘ì—­ì‹œ
    'ëŒ€êµ¬': { lat: 35.8714, lng: 128.6014 },
    'ìˆ˜ì„±êµ¬': { lat: 35.8580, lng: 128.6306 },
    'ë‹¬ì„œêµ¬': { lat: 35.8299, lng: 128.5327 },
    'ë‹¬ì„±êµ°': { lat: 35.7745, lng: 128.4316 },

    // ì¸ì²œê´‘ì—­ì‹œ
    'ì¸ì²œ': { lat: 37.4563, lng: 126.7052 },
    'ë¯¸ì¶”í™€êµ¬': { lat: 37.4635, lng: 126.6503 },
    'ì—°ìˆ˜êµ¬': { lat: 37.4100, lng: 126.6782 },
    'ë‚¨ë™êµ¬': { lat: 37.4473, lng: 126.7314 },
    'ë¶€í‰êµ¬': { lat: 37.5070, lng: 126.7218 },
    'ê³„ì–‘êµ¬': { lat: 37.5375, lng: 126.7377 },
    'ì„œêµ¬': { lat: 37.5454, lng: 126.6761 },
    'ê°•í™”êµ°': { lat: 37.7464, lng: 126.4880 },
    'ì˜¹ì§„êµ°': { lat: 37.4468, lng: 126.6367 },

    // ê´‘ì£¼ê´‘ì—­ì‹œ
    'ê´‘ì£¼': { lat: 35.1595, lng: 126.8526 },
    'ë™êµ¬': { lat: 35.1456, lng: 126.9234 }, // ê´‘ì£¼
    'ì„œêµ¬(ê´‘ì£¼)': { lat: 35.1521, lng: 126.8901 },
    'ë‚¨êµ¬(ê´‘ì£¼)': { lat: 35.1329, lng: 126.9025 },
    'ë¶êµ¬(ê´‘ì£¼)': { lat: 35.1740, lng: 126.9122 },
    'ê´‘ì‚°êµ¬': { lat: 35.1395, lng: 126.7937 },

    // ëŒ€ì „ê´‘ì—­ì‹œ
    'ëŒ€ì „': { lat: 36.3504, lng: 127.3845 },
    'ìœ ì„±êµ¬': { lat: 36.3622, lng: 127.3563 },
    'ëŒ€ë•êµ¬': { lat: 36.3466, lng: 127.4156 },

    // ìš¸ì‚°ê´‘ì—­ì‹œ
    'ìš¸ì‚°': { lat: 35.5384, lng: 129.3114 },
    'ìš¸ì£¼êµ°': { lat: 35.5218, lng: 129.2423 },

    // ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ
    'ì„¸ì¢…': { lat: 36.4800, lng: 127.2890 },
    'ì œì£¼': { lat: 33.4890, lng: 126.4983 },
    'ì œì£¼ì‹œ': { lat: 33.4996, lng: 126.5312 },
    'ì„œê·€í¬ì‹œ': { lat: 33.2541, lng: 126.5601 }
};

// ì£¼ì†Œì—ì„œ ê°€ì¥ ì ì ˆí•œ êµ¬/êµ° ì°¾ê¸°
function findBestCoords(address) {
    if (!address) return null;

    // 3ë‹¨ê³„ ë§¤ì¹­: ì‹œ/êµ°/êµ¬ -> êµ¬ -> ì‹œ

    // 1. Full Match (ì¢…ë¡œêµ¬, ê°•ë‚¨êµ¬ ë“± êµ¬ì²´ì ì¸ ê²ƒ ìš°ì„ )
    const keywords = Object.keys(DISTRICT_COORDS).sort((a, b) => b.length - a.length);

    for (const key of keywords) {
        if (address.includes(key)) {
            // ì¤‘ë³µ ì§€ëª… ì²˜ë¦¬ (ì˜ˆ: ê³ ì„±êµ°, ì„œêµ¬ ë“±)
            if (key === 'ê³ ì„±êµ°') {
                if (address.includes('ê°•ì›')) return DISTRICT_COORDS['ê³ ì„±êµ°'];
                if (address.includes('ê²½ë‚¨') || address.includes('ê²½ìƒë‚¨ë„')) return DISTRICT_COORDS['ê³ ì„±êµ°(ê²½ë‚¨)'];
            }
            if (key === 'ì„œêµ¬') {
                if (address.includes('ê´‘ì£¼')) return DISTRICT_COORDS['ì„œêµ¬(ê´‘ì£¼)'];
                // ëŒ€êµ¬/ë¶€ì‚°/ì¸ì²œ ì„œêµ¬ëŠ”... ì¼ë‹¨ ì¸ì²œ ì„œêµ¬ë¡œ (ì•½ì )
                if (address.includes('ë¶€ì‚°')) return DISTRICT_COORDS['ì„œêµ¬']; // ë¶€ì‚° ì„œêµ¬ ë°ì´í„° ì¶”ê°€ í•„ìš”í•˜ì§€ë§Œ ì¼ë‹¨
            }

            return DISTRICT_COORDS[key];
        }
    }

    return null;
}

function main() {
    console.log('ğŸ“ Running massively granular geocoding (Hardcoded Level)...');

    if (!fs.existsSync(DATA_FILE)) {
        console.error('âŒ facilities.json not found!');
        return;
    }

    const facilities = JSON.parse(fs.readFileSync(DATA_FILE, 'utf-8'));
    let count = 0;

    for (let i = 0; i < facilities.length; i++) {
        const facility = facilities[i];

        // ê¸°ì¡´ì— ì´ë¯¸ 'ìˆ˜ë™ ë§¤í•‘' ë“±ìœ¼ë¡œ ì •ë°€í•˜ê²Œ ì¡íŒ ê±´ ê±´ë„ˆëœ€
        // (location.latì´ ì •í™•íˆ ë§¤ì§ ë„˜ë²„(ë§¤ë‰´ì–¼ ê°’)ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ ì²´í¬ëŠ” ì–´ë µê³ ,
        // ì—¬ê¸°ì„œëŠ” ê·¸ëƒ¥ "ëª¨ë‘ ë‹¤ ì—…ë°ì´íŠ¸" í•˜ë˜, 'ì²­ê³„ê³µì›', 'ë™ì‚°ê³µì›' 2ê°œë§Œ ë³´í˜¸)
        if (facility.name.includes('ì²­ê³„ê³µì›') ||
            (facility.name.includes('ë™ì‚°ê³µì›ë¬˜ì›') && facility.name.includes('ì˜ë ¹'))) {
            continue;
        }

        const coords = findBestCoords(facility.address);

        if (coords) {
            // í•´ë‹¹ êµ¬ì‹¬ì ì—ì„œ ëœë¤í•˜ê²Œ í¼ëœ¨ë¦¼ (ë°˜ê²½ 1.5km ì •ë„)
            // 0.015ë„ â‰ˆ 1.5km
            const offsetLat = (Math.random() - 0.5) * 0.03;
            const offsetLng = (Math.random() - 0.5) * 0.03;

            facilities[i].coordinates = {
                lat: coords.lat + offsetLat,
                lng: coords.lng + offsetLng
            };
            facilities[i].location = facilities[i].coordinates;
            count++;
        }
    }

    fs.writeFileSync(DATA_FILE, JSON.stringify(facilities, null, 2));
    console.log(`\nâœ… Granularly hardcoded ${count} facilities.`);
}

main();
